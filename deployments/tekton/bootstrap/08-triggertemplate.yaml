# Generated by RepoSentry
# File: 07-triggertemplate.yaml
---
apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: reposentry-bootstrap-template
  namespace: reposentry-system
  labels:
    reposentry.io/component: "bootstrap"
    reposentry.io/type: "triggertemplate"
spec:
  params:
  - name: repo-url
    description: "Repository URL"
  - name: repo-branch
    description: "Repository branch"
    default: "main"
  - name: commit-sha
    description: "Commit SHA"
  - name: repo-full-name
    description: "Repository full name (org/repo)"
  - name: tekton-path
    description: "Path to Tekton resources in repository"
    default: ".tekton"
  resourcetemplates:
  - apiVersion: tekton.dev/v1beta1
    kind: PipelineRun
    metadata:
      generateName: reposentry-bootstrap-run-
      namespace: reposentry-system
      labels:
        reposentry.io/component: "bootstrap-run"
        reposentry.io/source: "cloudevent"
        reposentry.io/trigger-type: "bootstrap-pipeline"
        reposentry.io/branch: "$(tt.params.repo-branch)"
      annotations:
        reposentry.io/repository-url: "$(tt.params.repo-url)"
        reposentry.io/repo-full-name: "$(tt.params.repo-full-name)"
        reposentry.io/commit-sha: "$(tt.params.commit-sha)"
        reposentry.io/commit-full: "$(tt.params.commit-sha)"
        reposentry.io/source-branch: "$(tt.params.repo-branch)"
        reposentry.io/triggered-by: "reposentry-cloudevent"
        reposentry.io/naming-scheme: "v2-bootstrap"
    spec:
      pipelineRef:
        name: reposentry-bootstrap-pipeline
      params:
      - name: repo-url
        value: "$(tt.params.repo-url)"
      - name: repo-branch
        value: "$(tt.params.repo-branch)"
      - name: commit-sha
        value: "$(tt.params.commit-sha)"
      - name: repo-full-name
        value: "$(tt.params.repo-full-name)"
      - name: tekton-path
        value: "$(tt.params.tekton-path)"
      workspaces:
      - name: source-workspace
        volumeClaimTemplate:
          spec:
            accessModes:
            - ReadWriteOnce
            resources:
              requests:
                storage: 1Gi
      - name: tekton-workspace
        volumeClaimTemplate:
          spec:
            accessModes:
            - ReadWriteOnce
            resources:
              requests:
                storage: 1Gi
      serviceAccountName: reposentry-bootstrap-sa
---
