# RepoSentry 专用的 EventListener
apiVersion: triggers.tekton.dev/v1beta1
kind: EventListener
metadata:
  name: reposentry-test-listener
  namespace: tekton-pipelines
  labels:
    app: reposentry-test
    component: eventlistener
spec:
  serviceAccountName: tekton-triggers-webhook-sa
  triggers:
    - name: reposentry-trigger
      bindings:
        - ref: reposentry-trigger-binding
      template:
        ref: reposentry-trigger-template
      # 简化测试，暂时去掉拦截器
      # interceptors:
---
# NodePort Service for external access
apiVersion: v1
kind: Service
metadata:
  name: el-reposentry-test-listener-nodeport
  namespace: tekton-pipelines
spec:
  type: NodePort
  ports:
    - port: 8080
      targetPort: 8080
      nodePort: 30081
      name: http-listener
  selector:
    eventlistener: reposentry-test-listener
